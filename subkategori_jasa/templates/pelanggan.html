<!DOCTYPE html>
<html>
<head>
    <title>{{ nama_subkategori }} - Pelanggan</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <h1>{{ nama_subkategori }}</h1>
    <p>{{ deskripsi }}</p>

    <h2>Pekerja Tersedia</h2>
    <ul>
        {% for pekerja in pekerja_list %}
            <li>
                <a href="{% url 'subkategori_jasa:profil_pekera' pekerja.0 %}">{{ pekerja.1 }}</a> - Rating: {{ pekerja.2 }} - Pesanan Selesai: {{ pekerja.3 }}
            </li>
        {% endfor %}
    </ul>

    <h2>Sesi Layanan</h2>
    <table border="1" class="table">
        <thead>
            <tr>
                <th>Sesi</th>
                <th>Harga</th>
                <th>Aksi</th>
            </tr>
        </thead>
        <tbody>
            {% for sesi in sesi_layanan %}
                <tr>
                    <td>{{ sesi.0 }}</td>
                    <td>{{ sesi.1 }}</td>
                    <td>
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#pesanJasaModal" 
                                data-sesi="{{ sesi.0 }}" data-harga="{{ sesi.1 }}">Pesan Jasa</button>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <div class="modal fade" id="pesanJasaModal" tabindex="-1" aria-labelledby="pesanJasaModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <form method="post" action="{% url 'subkategori_jasa:buat_pemesanan_jasa' %}">
            {% csrf_token %}
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="pesanJasaModalLabel">Pesan Jasa</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                  <input type="hidden" name="subkategori_id" value="{{ subkategori_id }}">
                  <div class="mb-3">
                      <label for="sesi" class="form-label">Sesi Layanan</label>
                      <input type="text" class="form-control" id="sesi" name="sesi" readonly>
                  </div>
                  <div class="mb-3">
                      <label for="harga" class="form-label">Harga</label>
                      <input type="text" class="form-control" id="harga" name="harga" readonly>
                  </div>
                  <div class="mb-3">
                      <label for="tanggal_pemesanan" class="form-label">Tanggal Pemesanan</label>
                      <input type="date" class="form-control" id="tanggal_pemesanan" name="tanggal_pemesanan" required>
                  </div>
                  <div class="mb-3">
                      <label for="kode_diskon" class="form-label">Kode Diskon</label>
                      <input type="text" class="form-control" id="kode_diskon" name="kode_diskon" placeholder="Masukkan kode promo">
                  </div>
                  <div class="mb-3">
                      <label for="metode_bayar" class="form-label">Metode Bayar</label>
                      <select id="metode_bayar" name="metode_bayar" class="form-select" required>
                          <option value="">Pilih Metode Bayar</option>
                          {% for metode in metode_bayar_list %}
                              <option value="{{ metode.0 }}">{{ metode.1 }}</option>
                          {% endfor %}
                      </select>
                  </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                <button type="submit" class="btn btn-primary">Pesan</button>
              </div>
            </div>
        </form>
      </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        var pesanJasaModal = document.getElementById('pesanJasaModal')
        pesanJasaModal.addEventListener('show.bs.modal', function (event) {
            var button = event.relatedTarget
            var sesi = button.getAttribute('data-sesi')
            var harga = button.getAttribute('data-harga')
            
            var modalSesi = pesanJasaModal.querySelector('#sesi')
            var modalHarga = pesanJasaModal.querySelector('#harga')
            
            modalSesi.value = sesi
            modalHarga.value = harga
        })
    </script>
</body>
</html>
